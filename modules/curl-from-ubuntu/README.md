# curl-from-ubuntu Module

This is an example module demonstrating how to use the `build_from_ubuntu_packages.py` script to create OSv applications from Ubuntu packages.

## How it was created

This module was created with a single command:

```bash
./scripts/build_from_ubuntu_packages.py \
  -o modules/curl-from-ubuntu \
  -c "/usr/bin/curl --version" \
  --generate-module \
  curl
```

## Prerequisites

Before building, you need to populate the `extracted/` directory by running:

```bash
./scripts/build_from_ubuntu_packages.py \
  -o modules/curl-from-ubuntu \
  -c "/usr/bin/curl --version" \
  --generate-module \
  curl
```

This will download the Ubuntu package and extract it to `modules/curl-from-ubuntu/extracted/`.

## Building an image

To build an OSv image with this module:

```bash
./scripts/build image=curl-from-ubuntu
```

## Running

```bash
./scripts/run.py
```

The image will boot and execute `curl --version`.

## Customizing

To run curl with different arguments, you can override the command line:

```bash
./scripts/run.py -e "/usr/bin/curl https://example.com"
```

## Structure

- `extracted/` - Contains the files extracted from the curl Ubuntu package (not in git, generated by script)
- `downloads/` - Cached .deb files (not in git, generated by script)
- `usr.manifest` - OSv manifest mapping guest paths to host files
- `module.py` - OSv module definition with default command line
- `Makefile` - Makefile for `scripts/build` (no-op, since files are pre-extracted)
- `README.md` - This file
- `.gitignore` - Ignores extracted/ and downloads/

## Updating

To update to a newer version of curl:

```bash
rm -rf modules/curl-from-ubuntu/downloads/* modules/curl-from-ubuntu/extracted/*
./scripts/build_from_ubuntu_packages.py \
  -o modules/curl-from-ubuntu \
  -c "/usr/bin/curl --version" \
  --generate-module \
  curl
```

## Notes

This example only includes the `curl` package itself. The curl binary from Ubuntu depends on shared libraries which are not included. For a fully working curl, you would need to either:

1. Add dependency resolution: Use the `-d` flag to automatically include dependencies
2. Use with manifest_from_host.sh: Point to your host's curl installation
3. Link statically: Use a statically-built curl

For a more complete example with dependencies, see the README_UBUNTU_PACKAGES.md in the scripts directory.
